Banner: |

  INTERCEPT
  Policy as Code Static Analysis Auditing

ExitCritical: "Critical irregularities found in your code"
ExitWarning: "Irregularities found in your code"
ExitClean: "Clean report"

Rules:
  - id: 1
    name: NAME_TEXT
    description: DESCRIPTION_TEXT
    solution: SOLUTION_TEXT
    error: ERROR_TEXT
    environment: DEV
    type: scan
    fatal: true
    enforcement: true
    patterns:
      - regex_1
      - regex_2
      - regex_3

  - id: 2
    name: TruffleHog
    description: DESCRIPTION_TEXT
    error: ERROR_TEXT
    solution: SOLUTION_TEXT
    environment: PROD
    type: scan
    fatal: true
    enforcement: false
    patterns:
      - (xox[p|b|o|a]-[0-9]{12}-[0-9]{12}-[0-9]{12}-[a-z0-9]{32})
      - \s*(-----BEGIN RSA PRIVATE KEY-----)
      - \s*(-----BEGIN OPENSSH PRIVATE KEY-----)
      - \s*(-----BEGIN DSA PRIVATE KEY-----)
      - \s*(-----BEGIN EC PRIVATE KEY-----)
      - \s*(-----BEGIN PGP PRIVATE KEY BLOCK-----)
      - \s*([f|F][a|A][c|C][e|E][b|B][o|O][o|O][k|K].{0,30}['\"\\s][0-9a-f]{32}['\"\\s])
      - \s*([t|T][w|W][i|I][t|T][t|T][e|E][r|R].{0,30}['\"\\s][0-9a-zA-Z]{35,44}['\"\\s])
      - \s*([g|G][i|I][t|T][h|H][u|U][b|B].{0,30}['\"\\s][0-9a-zA-Z]{35,40}['\"\\s])
      - (\"client_secret\":\"[a-zA-Z0-9-_]{24}\")
      - \s*(AKIA[0-9A-Z]{16})
      - \s*([h|H][e|E][r|R][o|O][k|K][u|U].{0,30}[0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12})
      - \s*([s|S][e|E][c|C][r|R][e|E][t|T].{0,30}['\"\\s][0-9a-zA-Z]{32,45}['\"\\s])
      - \s*([a|A][p|P][i|I][_]?[k|K][e|E][y|Y].{0,30}['\"\\s][0-9a-zA-Z]{32,45}['\"\\s])
      - \s*(https://hooks.slack.com/services/T[a-zA-Z0-9_]{8}/B[a-zA-Z0-9_]{8}/[a-zA-Z0-9_]{24})
      - \s*(service_account)
      - \s*(SK[a-z0-9]{32})
      - \s*([a-zA-Z]{3,10}://[^/\\s:@]{3,20}:[^/\\s:@]{3,20}@.{1,100}[\"'\\s])

  - id: 666
    name: NAME_TEXT
    description: DESCRIPTION_TEXT
    error: ERROR_TEXT
    solution: SOLUTION_TEXT
    environment: ENVIRONMENT_ID
    type: scan
    fatal: true
    enforcement: false
    patterns:
      - regex_666

  - name: Endpoints
    description: Endpoints need to be validated on an environment scope
    type: collect
    patterns:
      - (http|https)






